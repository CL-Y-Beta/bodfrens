<h5 class="disclaimer">Bodfrens is only available on mobile, find us there!</h5>

<div class="container multiplayer"

  data-controller="multiplayerroom-subscription"
  data-multiplayerroom-subscription-room-id-value="<%= @room.id %>"
  data-multiplayerroom-subscription-current-user-value="<%= @player1.id %>"
  data-multiplayerroom-subscription-opponent-user-value="<%= @player2.id %>"
  data-multiplayerroom-subscription-current-user-data-id-value="<%= @player1_user_game_data.id %>"
  data-multiplayerroom-subscription-opponent-user-data-id-value="<%= @player2_user_game_data.id %>"
  data-multiplayerroom-subscription-current-user-xp-value="<%= @room.bonus ? @player1_user_game_data.game_xp : 0%>"
  data-multiplayerroom-subscription-opponent-user-xp-value="<%= @room.bonus ? @player2_user_game_data.game_xp : 0%>"
  data-multiplayerroom-subscription-current-user-end-xp-value="<%= @room.bonus ? @player1_bonus_xp + @player1_regular_xp : @player1_regular_xp %>"
  data-multiplayerroom-subscription-opponent-user-end-xp-value="<%= @room.bonus ? @player2_bonus_xp + @player2_regular_xp : @player2_regular_xp %>"
  data-multiplayerroom-subscription-seconds-left-value="900"  >




  <header class="multiplayer-top">
    <section class="timer">
      <%= content_tag(:h1, "Go!", data: {
        multiplayerroom_subscription_target: "timer",
        # seconds_until_end_value: 900
        # KIV this, for some reason it's not being read in the controller
      }) %>
    </section>
    <button type="button" class="multiplayer giveup-btn">Give Up</button>
  </header>

  <main class="current-user" data-multiplayerroom-subscription-target="player1exercise">
    <% @player1_regular_exercises.each do |active_exercise| %>
      <div class="user-btn" id="<%= active_exercise.id %>">
        <button class="icon" id="user-btn-img">
          <%= image_tag("svgs/search_logo_gray.svg") %>
        </button>
        <button type="button" class="button-user" data-action="click->multiplayerroom-subscription#updateActiveExercise" value="<%=active_exercise.exercise.exercise_xp%>" style="padding-left: 60px" id="<%= active_exercise.id %>">
          <h3 class="text fs-5"><%= active_exercise.exercise.title %></h3><h5 class="xp"><%= active_exercise.exercise.exercise_xp %>XP</h5>
        </button>
      </div>
    <% end %>
      <div class= "xp-container user" style="width:65%; ">
        <div class="progress-bar" style="background: grey;">
          <div class=<%= @room.bonus ? 'bonus-game-progressed-bar' : 'game-progressed-bar'%> data-game-target="barCurrentUser"></div>
        </div>
        <div class="d-flex xp-points earn-points">
            <p data-multiplayerroom-subscription-target="barExpCurrentUser">0</p><p data-multiplayerroom-subscription-target="barFinalExpCurrentUser"></p>
        </div>
      </div>
  </main>

  <main class="opponent" data-multiplayerroom-subscription-target="player2exercise">
    <section class="opponent-left">
      <% @player2_regular_exercises.each do |active_exercise| %>
        <div class="opponent-btn-container">
          <button type="button" class="opponent-button" id="<%= active_exercise.id %>">
            <h3 class="opp-button-text"><%= active_exercise.exercise.title %></h3>
          </button>
        </div>
      <% end %>
      <div class= "xp-container">
        <div class="progress-bar" style="background: grey;"></div>
          <div class=<%= @room.bonus ? 'bonus-game-progressed-bar' : 'game-progressed-bar'%> data-game-target="barOpponentUser"></div>
      </div>
    </section>
    <section class="opponent-right">
      <aside class= "opp-aside">
        <p class="opp-title">Your Bodfren</p>
        <%= image_tag("svgs/bodfrens_graphics-01.svg", class: "opp-img") %>
        <p class="opp-username">Username</p>
        <p class="opp-lvl">lvl 39</p>
        <p class="workout-complete">Workout Complete!</p>
        <p class="bonus-round">Your bodfren has opted for a bonus round!</p>
      </aside>
    </section>
  </main>

  <!---Modals---->

    <section class="hidden-modal animate__animated animate__fadeIn" id="bonusPromptModal" tabindex="-1" >
        <div class="modal-dialog" style="width:90%;">

          <div class="modal-content">
            <div class="modal-header">
            </div>
            <div class="modal-body">
              Congratulations! You finished your workout. <br>
              Opt for a bonus round?
            </div>
            <div class="modal-footer">
              <%= button_to "Yes", "#", data: {action: "click->game#startBonus"}, class: "main-orange-btn", style: "width: 150px; height: 50px;" %>
              <%= link_to "No", show_game_complete_room_path, class: "gray-modal-btn", style: "width: 150px; height: 50px;" %>
            </div>
          </div>
        </div>
      </div>
    </section>


</div>

<!-- The divs above are just for the scrolling animation and bg
find them under the _backgrounds.scss in components -->
<h5 class="disclaimer">Bodfrens is only available on mobile, find us there!</h5>
<div class="bg-container animate__animated animate__fadeIn" id="container-gray">
  <div class="bg-color-gray"></div>
</div>
